/*
HVDD_TextPoint
Author: Hugo van den Doel
Website: http://hugovdd.com
Description: Applies a text animation presets to selected layers. If no layers selected, it generates it.
*/

function applyTextPoint() {
  app.beginUndoGroup("Apply Text Point");

  var thisComp = app.project.activeItem; //Current compositon
  if (!thisComp || !(thisComp instanceof CompItem)) return alert("Please select composition first.");
  var selLayers = thisComp.selectedLayers; //Selected layers


  function applyPseudoEffect(layer) {
    var pseudoEffectData = { 
        name: "Text Evo Binance",
        matchName: "Pseudo/textevobinance",
        binary: "RIFX\x00\x00\x12&FaFXhead\x00\x00\x00\x10\x00\x00\x00\x03\x00\x00\x00D\x00\x00\x00\x01\x01\x00\x00\x00LIST\x00\x00\x12\x02bescbeso\x00\x00\x008\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00]\u00A8\x00\x1D\u00F8R\x00\x00\x00\x00\x00d\x00d\x00d\x00d?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\u00FF\u00FF\u00FF\u00FFLIST\x00\x00\x00\u00ACtdsptdot\x00\x00\x00\x04\u00FF\u00FF\u00FF\u00FFtdpl\x00\x00\x00\x04\x00\x00\x00\x02LIST\x00\x00\x00@tdsitdix\x00\x00\x00\x04\u00FF\u00FF\u00FF\u00FFtdmn\x00\x00\x00(ADBE Effect Parade\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x00@tdsitdix\x00\x00\x00\x04\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdsn\x00\x00\x00\x11Text Evo Binance\x00\x00LIST\x00\x00\x00dtdsptdot\x00\x00\x00\x04\u00FF\u00FF\u00FF\u00FFtdpl\x00\x00\x00\x04\x00\x00\x00\x01LIST\x00\x00\x00@tdsitdix\x00\x00\x00\x04\u00FF\u00FF\u00FF\u00FFtdmn\x00\x00\x00(ADBE End of path sentinel\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x10|sspcfnam\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x06\u00ACparTparn\x00\x00\x00\x04\x00\x00\x00\btdmn\x00\x00\x00(Pseudo/textevobinance-0000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pard\x00\x00\x00\u0094\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x0E\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\u00FF\u00FF\u00FF\u00FF\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0001\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pard\x00\x00\x00\u0094\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\nStrength\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\u00C2\u00C8\x00\x00B\u00C8\x00\x00\u00C2\u00C8\x00\x00B\u00C8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0002\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pard\x00\x00\x00\u0094\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\nDelay\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\u00C8\x00\x00\x00\x00\x00\x00B\u00C8\x00\x00?\u00C0\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0003\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pard\x00\x00\x00\u0094\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\nDistance\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\u00C6\x1C@\x00F\x1C@\x00\u00C3\u00FA\x00\x00C\u00FA\x00\x00BH\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0004\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pard\x00\x00\x00\u0094\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07In animation\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x02\x00\x03\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pdnm\x00\x00\x00\x16Top|Bottom|Left|Right\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0005\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pard\x00\x00\x00\u0094\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07Out animation\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x04\x00\x03\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pdnm\x00\x00\x00\x16Top|Bottom|Left|Right\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0006\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pard\x00\x00\x00\u0094\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\nSpeed In (frames)\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00CH\x00\x00\x00\x00\x00\x00CH\x00\x00A\u00A0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0007\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00pard\x00\x00\x00\u0094\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\nSpeed Out (frames)\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00CH\x00\x00\x00\x00\x00\x00CH\x00\x00A \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\t\u0084tdgptdsb\x00\x00\x00\x04\x00\x00\x00\x01tdsn\x00\x00\x00\x11Text Evo Binance\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x00\u00DAtdbstdsb\x00\x00\x00\x04\x00\x00\x00\x03tdsn\x00\x00\x00\x01\x00\x00tdb4\x00\x00\x00|\u00DB\u0099\x00\x01\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x02X?\x1A6\u00E2\u00EB\x1CC-?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x04\u00C0\u00C0\u00C0\u00FF\u00C0\u00C0\u00C0\x00\x00\x00\x00\u0080\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00cdat\x00\x00\x00(\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdpi\x00\x00\x00\x04\x00\x00\x00\x0Etdmn\x00\x00\x00(Pseudo/textevobinance-0001\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x00\u00F6tdbstdsb\x00\x00\x00\x04\x00\x00\x00\x01tdsn\x00\x00\x00\tStrength\x00\x00tdb4\x00\x00\x00|\u00BD\u0099\x00\x01\x00\x01\x00\x00\x00\x01\x00\u00FF\x00\x00]\u00A8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00cdat\x00\x00\x00(\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdum\x00\x00\x00\b\u00C0Y\x00\x00\x00\x00\x00\x00tduM\x00\x00\x00\b@Y\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0002\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x00\u00F2tdbstdsb\x00\x00\x00\x04\x00\x00\x00\x01tdsn\x00\x00\x00\x06Delay\x00tdb4\x00\x00\x00|\u00BD\u0099\x00\x01\x00\x01\x00\x00\x00\x01\x00\u00FF\x00\x00]\u00A8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00cdat\x00\x00\x00(?\u00F8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdum\x00\x00\x00\b\x00\x00\x00\x00\x00\x00\x00\x00tduM\x00\x00\x00\b@Y\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0003\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x00\u00F6tdbstdsb\x00\x00\x00\x04\x00\x00\x00\x01tdsn\x00\x00\x00\tDistance\x00\x00tdb4\x00\x00\x00|\u00BD\u0099\x00\x01\x00\x01\x00\x00\x00\x01\x00\u00FF\x00\x00]\u00A8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00cdat\x00\x00\x00(@I\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdum\x00\x00\x00\b\u00C0\x7F@\x00\x00\x00\x00\x00tduM\x00\x00\x00\b@\x7F@\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0004\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x00\u00DAtdbstdsb\x00\x00\x00\x04\x00\x00\x00\x01tdsn\x00\x00\x00\rIn animation\x00\x00tdb4\x00\x00\x00|\u00DB\u0099\x00\x01\x00\x01\x00\x00\x00\x01\x00\u00FF\x00\x00]\u00A8?\x1A6\u00E2\u00EB\x1CC-?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00cdat\x00\x00\x00(@\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0005\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x00\u00DAtdbstdsb\x00\x00\x00\x04\x00\x00\x00\x01tdsn\x00\x00\x00\x0EOut animation\x00tdb4\x00\x00\x00|\u00DB\u0099\x00\x01\x00\x01\x00\x00\x00\x01\x00\u00FF\x00\x00]\u00A8?\x1A6\u00E2\u00EB\x1CC-?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00?\u00F0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00cdat\x00\x00\x00(@\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0006\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x00\u00FEtdbstdsb\x00\x00\x00\x04\x00\x00\x00\x01tdsn\x00\x00\x00\x12Speed In (frames)\x00tdb4\x00\x00\x00|\u00BD\u0099\x00\x01\x00\x01\x00\x00\x00\x01\x00\u00FF\x00\x00]\u00A8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00cdat\x00\x00\x00(@4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdum\x00\x00\x00\b\x00\x00\x00\x00\x00\x00\x00\x00tduM\x00\x00\x00\b@i\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(Pseudo/textevobinance-0007\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00LIST\x00\x00\x01\x00tdbstdsb\x00\x00\x00\x04\x00\x00\x00\x01tdsn\x00\x00\x00\x13Speed Out (frames)\x00\x00tdb4\x00\x00\x00|\u00BD\u0099\x00\x01\x00\x01\x00\x00\x00\x01\x00\u00FF\x00\x00]\u00A8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00cdat\x00\x00\x00(@$\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00tdum\x00\x00\x00\b\x00\x00\x00\x00\x00\x00\x00\x00tduM\x00\x00\x00\b@i\x00\x00\x00\x00\x00\x00tdmn\x00\x00\x00(ADBE Group End\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00{\"controlName\":\"Text Evo Binance\",\"matchname\":\"Pseudo/textevobinance\",\"controlArray\":[{\"name\":\"Strength\",\"type\":\"slider\",\"canHaveKeyframes\":true,\"canBeInvisible\":true,\"invisible\":false,\"keyframes\":true,\"id\":4965804845,\"hold\":false,\"default\":0,\"sliderMax\":100,\"sliderMin\":-100,\"validMax\":100,\"validMin\":-100,\"precision\":0,\"percent\":true,\"pixel\":false,\"open\":false,\"errors\":[\n\n],\"error\":[\n\n]},{\"name\":\"Delay\",\"type\":\"slider\",\"canHaveKeyframes\":true,\"canBeInvisible\":true,\"invisible\":false,\"keyframes\":true,\"id\":5368169634,\"hold\":false,\"default\":1.5,\"sliderMax\":100,\"sliderMin\":0,\"validMax\":100,\"validMin\":0,\"precision\":2,\"percent\":false,\"pixel\":false,\"open\":false,\"errors\":[\n\n],\"error\":[\n\n]},{\"name\":\"Distance\",\"type\":\"slider\",\"canHaveKeyframes\":true,\"canBeInvisible\":true,\"invisible\":false,\"keyframes\":true,\"id\":9445880279,\"hold\":false,\"default\":50,\"sliderMax\":500,\"sliderMin\":-500,\"validMax\":10000,\"validMin\":-10000,\"precision\":0,\"percent\":false,\"pixel\":false,\"open\":false,\"errors\":[\n\n],\"error\":[\n\n]},{\"name\":\"In animation\",\"type\":\"popup\",\"canHaveKeyframes\":true,\"canBeInvisible\":true,\"invisible\":false,\"keyframes\":false,\"id\":9948420528,\"hold\":false,\"default\":2,\"content\":\"Top|Bottom|Left|Right\",\"error\":[\n\n]},{\"name\":\"Out animation\",\"type\":\"popup\",\"canHaveKeyframes\":true,\"canBeInvisible\":true,\"invisible\":false,\"keyframes\":false,\"id\":8582256034,\"hold\":false,\"default\":4,\"content\":\"Top|Bottom|Left|Right\",\"error\":[\n\n]},{\"name\":\"Speed In (frames)\",\"type\":\"slider\",\"canHaveKeyframes\":true,\"canBeInvisible\":true,\"invisible\":false,\"keyframes\":true,\"id\":3954637217,\"hold\":false,\"default\":20,\"sliderMax\":200,\"sliderMin\":0,\"validMax\":200,\"validMin\":0,\"precision\":0,\"percent\":false,\"pixel\":false,\"open\":false,\"errors\":[\n\n],\"error\":[\n\n]},{\"name\":\"Speed Out (frames)\",\"type\":\"slider\",\"canHaveKeyframes\":true,\"canBeInvisible\":true,\"invisible\":false,\"keyframes\":true,\"id\":4047277866,\"hold\":false,\"default\":10,\"sliderMax\":200,\"sliderMin\":0,\"validMax\":200,\"validMin\":0,\"precision\":0,\"percent\":false,\"pixel\":false,\"open\":false,\"errors\":[\n\n],\"error\":[\n\n]}],\"version\":3}",
      };
    var pseudoEffect,
        ffxFile,
        writeFile = function (pathToFile, content, encoding) {
            var fileObject = new File(pathToFile);
            fileObject.encoding = encoding || "utf-8";
            fileObject.open("w");
            fileObject.write(content);
            fileObject.close();
            return fileObject;
        },
        makePseudoEffectLive = function (ffxFile) {
            var tempComp, tempLayer;
            tempComp = app.project.items.addComp("tempComp", 100, 100, 1, 1, 24);
            tempLayer = tempComp.layers.addShape();
            tempLayer.applyPreset(ffxFile);
            tempComp.remove();
        };

    if (!layer.property("ADBE Effect Parade").canAddProperty(pseudoEffectData.matchName)) {
        ffxFile = writeFile(Folder.desktop.fsName + "/" + pseudoEffectData.name + ".ffx", pseudoEffectData.binary, "BINARY");
        makePseudoEffectLive(ffxFile);
    }
    pseudoEffect = layer.property("ADBE Effect Parade").addProperty(pseudoEffectData.matchName);
    layer.effect(1).name = "Text Point";
  }

  function applyAnimatorProps(layer){
    var prop = layer.property("ADBE Text Properties").property(4);
    if (prop.property("Text Point") == null){
        layer.property("ADBE Text Properties").property(4).addProperty("ADBE Text Animator");
        layer.property("ADBE Text Properties").property(4).property(1).name = "Text Point";
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Anchor Point 3D");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Position 3D");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Scale 3D");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Skew");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Skew Axis");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Rotation");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Opacity");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Stroke Width");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Line Anchor");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Tracking Amount");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Character Replace");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Character Offset");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Line Spacing");
        layer.property("ADBE Text Properties").property(4).property(1).property("ADBE Text Animator Properties").addProperty("ADBE Text Blur");
        layer.property("ADBE Text Properties").property(4).property(1).property(1).addProperty("ADBE Text Expressible Selector");
        layer.property("ADBE Text Properties").property(4).property(1).property(1).property(1).name = "textpoint";
        layer.property("ADBE Text Properties").property(4).property(1).property(1).property(1).property("ADBE Text Range Type2").setValue(3);
        layer.property("ADBE Text Properties").property(4).property(1).property(1).property(1).property("ADBE Text Expressible Amount").setValue([100,100,100]);
        layer.property("ADBE Text Properties").property(4).property(1).property(2).property("ADBE Text Position 3D").setValue([0,0,0]);
        layer.property("ADBE Text Properties").property(4).property(1).property(2).property("ADBE Text Opacity").setValue(0);
    }
  }
  

  function removeTextPoint(layer){
    var prop = layer.property("ADBE Text Properties").property("ADBE Text Animators").property("Text Point");
    if(prop != null){
        if(prop.matchName == "ADBE Text Animator"){
            prop.remove();
        }
    }
    var fx = layer.effect("Text Point");
    if(fx != null){
        if(fx.matchName == "Pseudo/textpoint"){
            fx.remove();
        } 
    }   
  }

  function removeTextEvo(layer){
    var prop = layer.property("ADBE Text Properties").property("ADBE Text Animators").property("TextEvo");
    if(prop != null){
        if(prop.matchName == "ADBE Text Animator"){
            prop.remove();
        }
    }
    var fx = layer.effect("TextEvo");
    if(fx != null){
        if(fx.matchName == "Pseudo/textevo"){
            fx.remove();
        } 
    }   
  }


  function applyExpressions(layer){
    layer.property("ADBE Text Properties").property(4).property(1).property(1).property(1).property("ADBE Text Expressible Amount").expression = "//TextPoint - Amount Expression\r\rvar fx= effect(\"Text Point\");\rif(fx.active){\r    var v = effect(\"Text Evo Binance\")(\"Strength\");\rvar delay = effect(\"Text Evo Binance\")(\"Delay\");\rvar sens = 1;\r\r\r\rswitch (sens) {\r    case 1:\r        offset = (textIndex - 1) * thisComp.frameDuration * delay;\r        break;\r    case 2:\r        offset = (textTotal - textIndex) * thisComp.frameDuration * delay;\r        break;\r    case 3:\r        if (textTotal & 1) {\r            if (textIndex == demi) {\r                offset = 0\r            } else if (textIndex < demi) {\r                offset = (textTotal - textIndex - demi + 1) * thisComp.frameDuration * delay\r            } else {\r                offset = (textIndex - demi) * thisComp.frameDuration * delay\r            }\r        } else {\r            if (textIndex == demi || textIndex == demi + 1) {\r                offset = 0\r            } else if (textIndex < demi) {\r                offset = (textTotal - textIndex - demi) * thisComp.frameDuration * delay\r            } else {\r                offset = (textIndex - demi - 1) * thisComp.frameDuration * delay\r            }\r        }\r        break;\r    case 4:\r        if (textIndex <= textTotal / 2) {\r            offset = (textIndex - 1) * thisComp.frameDuration * delay\r        } else {\r            offset = (textTotal - textIndex) * thisComp.frameDuration * delay\r        }\r        break;\r    case 5:\r        offset = thisComp.frameDuration * random(delay * textTotal);\r        break;\r    case 6:\r        if (textIndex == fromIndex) {\r            offset = 0\r        } else if (textIndex < fromIndex) {\r            offset = (fromIndex - textIndex) * thisComp.frameDuration * delay\r        } else {\r            offset = (textIndex - fromIndex) * thisComp.frameDuration * delay\r        }\r        break\r}\rt = time - offset;\rv.valueAtTime(t)\r\t\r}else{\r    0;\r}\r";
    layer.property("ADBE Text Properties").property(4).property(1).property(2).property("ADBE Text Position 3D").expression = "//Text Evo Binance - Position Expression\r\rvar distance= effect(\"Text Evo Binance\")(\"Distance\");\rvar framesIn = effect(\"Text Evo Binance\")(\"Speed In (frames)\");\rvar delay = effect(\"Text Evo Binance\")(\"Delay\");\r\r//Calculate buffer\rvar charCount = thisLayer.text.sourceText.length;\rvar wordCount = thisLayer.text.sourceText.split(/ ,| | \\./).length;\rvar numberOfLines = thisLayer.text.sourceText.valueAtTime(time).split('\\r').length;\rvar buffer = 0;\r\r\r//Adjust multiplier when \"based on\" changes\rvar multiplier = charCount;\rif (text.animator(\"TextEvo Binance\").selector(\"textevo-binance\").basedOn == 3){ //words\r\tmultiplier = wordCount;\r} else if (text.animator(\"TextEvo Binance\").selector(\"textevo-binance\").basedOn == 4){ //lines\r\tmultiplier = numberOfLines;\r}\r\rbuffer = (multiplier - 1) * delay;\r\r//Start direction\rvar start;\rswitch(effect(\"Text Evo Binance\")(\"In animation\").value){\r\tcase 1: //Top \r\t  start = [0 , - distance];\r\t  break;\r\tcase 2: //Bottom\r\t  start = [0, distance];\r\t  break;\r\tcase 3: // Left\r\t  start = [- distance, 0];\r\t  break;\r\tcase 4: //Right\r\t  start = [distance, 0];\r\t  break;\r}\r\r\r//End direction\rvar end;\rswitch(effect(\"Text Evo Binance\")(\"Out animation\").value){\r\tcase 1: //Top \r\t  end = [0 , - distance];\r\t  break;\r\tcase 2: //Bottom\r\t  end = [0, distance];\r\t  break;\r\tcase 3: // Left\r\t  end = [- distance, 0];\r\t  break;\r\tcase 4: //Right\r\t  end = [distance, 0];\r\t  break;\r}\r\r\rv = start\r//Check if start transition\rvar inTransitionTime = thisLayer.inPoint + framesToTime(framesIn) + framesToTime(buffer);\r\rif (time > inTransitionTime){ v = end };\r\rv;\r\r\r\r\r";
    layer.property("ADBE Effect Parade").property(1).property("Pseudo/textevobinance-0001").expression = "var framesIn = effect(\"Text Evo Binance\")(\"Speed In (frames)\");\rvar framesOut= effect(\"Text Evo Binance\")(\"Speed Out (frames)\");\rvar speedIn = framesToTime(framesIn);\rvar speedOut = framesToTime(framesOut);\rvar t = time;\rvar fx= effect(\"Text Evo Binance\");\rvar delay = effect(\"Text Evo Binance\")(\"Delay\");\r\r//Calculate buffer\rvar charCount = thisLayer.text.sourceText.length;\rvar wordCount = thisLayer.text.sourceText.split(/ ,| | \\./).length;\rvar numberOfLines = thisLayer.text.sourceText.valueAtTime(time).split('\\r').length;\rvar buffer = 0;\r\r\r//Adjust multiplier when \"based on\" changes\rvar multiplier = charCount;\rif (text.animator(\"TextEvo Binance\").selector(\"textevo-binance\").basedOn == 3){ //words\r\tmultiplier = wordCount;\r} else if (text.animator(\"TextEvo Binance\").selector(\"textevo-binance\").basedOn == 4){ //lines\r\tmultiplier = numberOfLines;\r}\r\rbuffer = (multiplier - 1) * delay;\r\r\r//Convert CSS easing to AE easing\rfunction customBezier(t,tMin,tMax,value1,value2,bezierPoints){if(arguments.length!==6)return value;var a=value2-value1;var b=tMax-tMin;var c=clamp((t-tMin)/b,0,1);if(!(bezierPoints instanceof Array)||bezierPoints.length!==4)bezierPoints=[0,0,1,1];return a*h(c,bezierPoints)+value1;function h(f,g){var x=3*g[0];var j=3*(g[2]-g[0])-x;var k=1-x-j;var l=3*g[1];var m=3*(g[3]-g[1])-l;var n=1-l-m;var d=f;for(var i=0;i<5;i++){var z=d*(x+d*(j+d*k))-f;if(Math.abs(z)<1e-3)break;d-=z/(x+d*(2*j+3*k*d));}return d*(l+d*(m+d*n));}}\r\r\r//Set in and out easing    \rvar tr;\rvar inTransitionTime = thisLayer.inPoint + framesToTime(framesIn);\r\rif (t < inTransitionTime){\r    tr = customBezier(t, thisLayer.inPoint, thisLayer.inPoint + speedIn, 100, 0, [0.07, 0.24, 0.16, 1.00]);\r} else if (t > inTransitionTime) {\r    tr = customBezier(t, thisLayer.outPoint - speedOut - framesToTime(buffer), thisLayer.outPoint - framesToTime(buffer), 0, 100, [0.63, 0.02, 0.99, 0.70]);\r} else { value };\r\t\rtr;\r";
  }

  function generateTextLayer(){
    var layer = thisComp.layers.addText("Text layer");
    layer.inPoint = thisComp.time;
    layer.outPoint = layer.inPoint + 4.00;
    applyAnimatorProps(layer);
    applyPseudoEffect(layer);  
    applyExpressions(layer);
    layer.selected = true;
    app.executeCommand(2771);
    app.executeCommand(2771);
  }

  function cleanUp(layer){
    removeTextEvo(layer);
    var prop = layer.property("ADBE Text Properties").property("ADBE Text Animators").property("TextEvo Binance");
    if(prop != null){
        if(prop.matchName == "ADBE Text Animator"){
            removeTextEvoBinance(layer);
        }
    } else {
        applyPseudoEffect(layer);  
        applyAnimatorProps(layer);
        applyExpressions(layer);
        layer.selected = true;
        app.executeCommand(2771);
        app.executeCommand(2771);
    }

  }

  if (!thisComp || !(thisComp instanceof CompItem)){
    return alert("Please select composition first.");
  } else if (selLayers.length == 0) {
    generateTextLayer();
  } else {
    for (i = 0; i < selLayers.length; i++) { // Loop through selected Layer
      cleanUp(selLayers[i]);
      }
  }
  

  
  app.endUndoGroup();
}

applyTextPoint();
